# è½¯ä»¶åŒ…ç®¡ç†

## ä½¿ç”¨rpmå‘½ä»¤ç®¡ç†è½¯ä»¶åŒ…

### å¦‚ä½•çœ‹rpmåŒ…

<aside>
ğŸ’¡ rpmåŒ…åç§°ä¸€èˆ¬éƒ½ä¼šæ ‡æ˜ åŒ…å ç‰ˆæœ¬å· å‘è¡Œæ¬¡æ•° é€‚ç”¨å¹³å° è½¯ä»¶ä½æ•° ï¼ˆi686 ä¸ i386 X86 è¡¨ç¤º32ä½è½¯ä»¶ X86_64è¡¨ç¤ºè¿™æ˜¯64ä½è½¯ä»¶ï¼‰åç¼€å

</aside>

### å®‰è£…rpmåŒ…

**æŒ‚è½½é•œåƒ**

```bash
[root@CitProbe dev] **mkdir /iso**
[root@CitProbe dev] **mount /dev/sr0 /iso #æŒ‚è½½æœ¬åœ°ä»“åº“**
mount: /iso: WARNING: source write-protected, mounted read-only.
[root@CitProbe dev] cd /iso
[root@CitProbe iso] ls
AppStream  EULA              images      RPM-GPG-KEY-redhat-beta
BaseOS     extra_files.json  isolinux    RPM-GPG-KEY-redhat-release
EFI        GPL               media.repo
[root@CitProbe iso] cd BaseOS/
[root@CitProbe BaseOS] ls
Packages  repodata
[root@CitProbe BaseOS] cd Packages/
[root@CitProbe Packages] ls | grep xz
xz-5.2.5-8.el9_0.x86_64.rpm
xz-libs-5.2.5-8.el9_0.i686.rpm
xz-libs-5.2.5-8.el9_0.x86_64.rpm
```

**å®‰è£…**

`rpm å‚æ•° åŒ…å`

```bash
-i installå®‰è£…
-v å®‰è£…æ—¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
-h æ˜¾ç¤ºè¿›åº¦
-e å¸è½½
-f æ ¹æ®æ–‡ä»¶åå­—åæ¨è¯¥æ–‡ä»¶æ˜¯ä»€ä¹ˆåŒ…è£…å‡ºæ¥çš„
-q æ˜¾ç¤ºæŒ‡å®šè½¯ä»¶åŒ…æ˜¯å¦å·²å®‰è£…
```

```bash
[root@CitProbe Packages] **rpm -ivh xz-5.2.5-8.el9_0.x86_64.rpm**
warning: xz-5.2.5-8.el9_0.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID fd431d51: NOKEY
Verifying...                                                            (10################################# [100%]
Preparing...                                                            (10################################# [100%]
        package xz-5.2.5-8.el9_0.x86_64 is already installed
```

<aside>
ğŸš« **rpm** åŒ…ç®¡ç†å™¨çš„è‡´å‘½é—®é¢˜â€”ä¾èµ–é—®é¢˜

</aside>

```bash
[root@CitProbe Packages] **rpm -evh xz**
error: Failed dependencies:
        **xz is needed by (installed) dracut-057-21.git20230214.el9.x86_64
        xz is needed by (installed) sos-4.5.1-3.el9_2.noarch**
```

### ä½¿ç”¨yumç®¡ç†rpmåŒ…

<aside>
ğŸ’¡ yum è¯ç”Ÿç›®çš„å°±æ˜¯ä¸ºäº†è§£å†³rpmä¾èµ–å…³ç³»

</aside>

**åº“çš„æ¦‚å¿µ ï¼ˆrepository â€” repoï¼‰**

<aside>
ğŸ’¡ æ‰€è°“è½¯ä»¶ä»“åº“ åŒ…å«ä¸¤éƒ¨åˆ† ä¸€éƒ¨åˆ†æ˜¯æ‰€æœ‰è½¯ä»¶åŒ… å¦ä¸€éƒ¨åˆ†æ˜¯æ‰€æœ‰è½¯ä»¶åŒ…çš„å…ƒæ•°æ® å…ƒæ•°æ®ç›¸å½“äºæ‰€æœ‰è½¯ä»¶åŒ…çš„åå­—å’Œæ‰€æœ‰è½¯ä»¶åŒ…çš„ä¾èµ–å…³ç³» yumå°±æ˜¯è®¿é—®è½¯ä»¶ä»“åº“çš„å…ƒæ•°æ® è¿›è€Œæ ¹æ®å…ƒæ•°æ®é‡Œé¢çš„è®°å½•è‡ªåŠ¨è§£å†³è½¯ä»¶åŒ…çš„ä¾èµ–å…³ç³»

</aside>

**ä¸ºæ•ˆç‡æä¾›è§£å†³æ–¹æ¡ˆ** **ï¼ˆsolutionï¼‰**

<aside>
ğŸ’¡ repodataæ–‡ä»¶æä¾›äº†å…ƒæ•°æ® ç”¨äºè§£å†³ä¾èµ–å…³ç³»

</aside>

**æ­å»ºyumä»“åº“**

<aside>
âš ï¸ yumå¹¶æ²¡æœ‰ä»0åˆ›å»ºä»“åº“çš„èƒ½åŠ› ä»“åº“çš„æœ¬è´¨æ˜¯rpmåŒ…+repodataå…ƒæ•°æ® yumåªè¦è®¿é—®åˆ°repodata å°±èƒ½æ¥ç®¡rpmä»“åº“

</aside>

yumé…ç½®æ–‡ä»¶åœ¨ `/etc/yum.conf` 

yumçš„ä»“åº“æ–‡ä»¶æ‰€åœ¨ç›®å½•åœ¨ `/etc/yum.repos.d`

**yumä»“åº“çš„è¯­æ³•**

```bash
[iso]

#ä»“åº“åç§°
name = iso's repo

#è®¾ç½®å¼€å¯çŠ¶æ€ é»˜è®¤å¼€å¯
enable = yes

#è®¾ç½®è½¯ä»¶åŒ…æ ¡éªŒæ˜¯å¦å¼€å¯ æ­¤å¤„å…³é—­
gpgcheck = 0

#baseurl is a repodata s location not a repodata s path , location is a deal of file s system .
baseurl = file:///iso/BaseOS
#file:// is localhost-file-system

[appstream]
name = apppp
enable = yes
gegcheck = 0
baseurl = file:///iso/AppStream
```

**æŸ¥çœ‹yumæ¥ç®¡çš„æ‰€æœ‰ä»“åº“**

`yum repolist all`

```bash
[root@CitProbe yum.repos.d] **yum repolist all**
Updating Subscription Management repositories.
Unable to read consumer identity

This system is not registered with an entitlement server. You can use subscription-manager to register.

repo id                          repo name                          status
appstream                        apppp                              enabled
iso                              iso's repo                         enabled
```

æŸ¥çœ‹yumæ¥ç®¡ä»“åº“çš„æ‰€æœ‰è½¯ä»¶åŒ…

`yum list` 

```bash
[root@CitProbe yum.repos.d] yum list | wc -l
6604

#ç”±æ­¤å¯è§ yumæ¥ç®¡ä»“åº“çš„è½¯ä»¶åŒ…æ•°é‡ä¸º6604ä¸ª
```

<aside>
ğŸ’¡ åœ¨æ‰§è¡Œ `yum list`  yumåœ¨åˆ—å‡ºæ‰€æœ‰è½¯ä»¶çš„åŒæ—¶ä¹Ÿåœ¨åˆ›å»ºç¼“å­˜ï¼ˆcacheï¼‰ æœ‰äº†ç¼“å­˜ yum ä¸‹è½½è½¯ä»¶åŒ…å°±å¯ä»¥å®ç°Tabé”®è¡¥å…¨

</aside>

**æ¸…é™¤cache**

`yum clean all`

```bash
[root@CitProbe yum.repos.d] **yum clean all**
Updating Subscription Management repositories.
Unable to read consumer identity

This system is not registered with an entitlement server. You can use subscription-manager to register.

13 files removed
```

**åˆ¶ä½œchche**

`yum makecache`

```bash
[root@CitProbe yum.repos.d] **yum makecache**
Updating Subscription Management repositories.
Unable to read consumer identity

This system is not registered with an entitlement server. You can use subscription-manager to register.

iso's repo                                 177 MB/s | 1.7 MB     00:00
apppp                                      188 MB/s | 6.3 MB     00:00
Metadata cache created.
```

**æœç´¢å…³é”®å­—**

`yum search keyword`

```bash
[root@CitProbe yum.repos.d] **yum search tmux**
Updating Subscription Management repositories.
Unable to read consumer identity

This system is not registered with an entitlement server. You can use subscription-manager to register.

Last metadata expiration check: 0:00:56 ago on Thu 11 Jul 2024 04:31:36 PM CST.
======================= Name Exactly Matched: tmux ========================
tmux.x86_64 : A terminal multiplexer
```

**æœç´¢å‘½ä»¤æ‰€åœ¨è½¯ä»¶åŒ…**

`yum provides command`

```bash
[root@CitProbe yum.repos.d] **yum provides tmux**
Updating Subscription Management repositories.
Unable to read consumer identity

This system is not registered with an entitlement server. You can use subscription-manager to register.

Last metadata expiration check: 0:01:52 ago on Thu 11 Jul 2024 04:31:36 PM CST.
tmux-3.2a-4.el9.x86_64 : A terminal multiplexer
Repo        : @System
Matched from:
Provide    : tmux = 3.2a-4.el9

tmux-3.2a-4.el9.x86_64 : A terminal multiplexer
Repo        : iso
Matched from:
Provide    : tmux = 3.2a-4.el9
```

**å®‰è£…è½¯ä»¶åŒ…**

`yum install rpm-name`

**åˆ é™¤è½¯ä»¶åŒ…**

`yum remove rpm-name`

<aside>
ğŸ’¡ yumä»“åº“å¯ä»¥é…åœ¨ä¸€ä¸ªæ–‡ä»¶ ä¹Ÿå¯ä»¥é…åœ¨å¤šä¸ªæ–‡ä»¶ åªè¦æ–‡ä»¶ç»“å°¾éƒ½æ˜¯ `.repo` å³å¯

</aside>

### ä½¿ç”¨Internetä»“åº“æ­å»ºyum

**åªéœ€è¦å°†baseurlæŒ‡å®šInternetè·¯å¾„å³å¯**

### å±€åŸŸç½‘æ­å»ºä»“åº“çš„é‡è¦æ€§

`reposync --repo ä»“åº“åå­— -p ä¸‹è½½è·¯å¾„`

<aside>
ğŸ’¡ è¿™æ˜¯ä¸ªè§£å†³æ–¹æ¡ˆ ç”¨äºç½‘ç»œå¸¦å®½ä¸æœºå™¨æ•°é‡ å®é™…ä¸Š è¿™ä¸ªæ“ä½œçš„ç›®çš„å°±æ˜¯å°†ç½‘ç»œä¸Šçš„rpmåŒ…ä¸‹è½½åˆ°æœ¬åœ°çš„æ–‡ä»¶å¤¹ä¸­ ä¾›å…¶ä»–å±€åŸŸç½‘è®¾å¤‡ä½¿ç”¨

</aside>

**åˆ›å»ºrepodata**

`yum -y install createrepo`

`createrepo -v å«rpmçš„è·¯å¾„`

**yumä¼šè®°å½•æ¯ä¸€æ¬¡æ“ä½œ**

```bash
[root@CitProbe yum.repos.d] **yum history**
Updating Subscription Management repositories.
Unable to read consumer identity

This system is not registered with an entitlement server. You can use subscription-manager to register.

ID     | Command line             | Date and time    | Action(s)      | Altered
-------------------------------------------------------------------------------
     2 | install tmux             | 2024-07-03 17:53 | Install        |    1
     1 |                          | 2024-06-15 08:02 | Install        | 1198 EE
```

**æ’¤å›yumæ“ä½œ**

`yum history undo ID`

**é‡å¤yumæ“ä½œ**

`yum history do ID`

**å†æ¬¡ä¸‹è½½**

`yum reinstall åŒ…å`

**è½¯ä»¶åŒ…å‡çº§**

`yum update åŒ…å ç‰ˆæœ¬å·`

**ç³»ç»Ÿå‡çº§**

`yum upgrade`

### yumè½¯ä»¶åŒ…ç»„

<aside>
ğŸ’¡ è½¯ä»¶åŒ…ç»„å°±æ˜¯ä¸€ç»„è½¯ä»¶æ‰“åŒ… å’Œè¿›ç¨‹ä¸æœåŠ¡çš„å…³ç³»ç±»ä¼¼

</aside>

`yum group install åŒ…ç»„å`

**æŸ¥çœ‹æœ¬åœ°æœ‰çš„è½¯ä»¶åŒ…ç»„**

```bash
[root@CitProbe yum.repos.d] yum group list
Updating Subscription Management repositories.
Unable to read consumer identity

This system is not registered with an entitlement server. You can use subscription-manager to register.

Last metadata expiration check: 0:19:13 ago on Thu 11 Jul 2024 08:31:15 PM CST.
Available Environment Groups:
   Server
   Minimal Install
   Workstation
   Custom Operating System
   Virtualization Host
Installed Environment Groups:
   Server with GUI
Installed Groups:
   Container Management
   Headless Management
Available Groups:
   Legacy UNIX Compatibility
   Console Internet Tools
   Development Tools
   .NET Development
   Graphical Administration Tools
   Network Servers
   RPM Development Tools
   Scientific Support
   Security Tools
   Smart Card Support
   System Tools
```

**yumå­˜åœ¨çš„é—®é¢˜**

<aside>
âš ï¸ åœ¨æ—©æœŸRHELç‰ˆæœ¬ å¦‚æœyumå½“å‰æ­£åœ¨å®‰è£…è½¯ä»¶ å°†ä¸èƒ½åœ¨å…¶ä»–ä¼šè¯ä¸­ä½¿ç”¨yum ç”±æ­¤å¯è§ yumæ˜¯ä¸ªå•çº¿ç¨‹ç¨‹åº

</aside>

**åœ¨ç°åœ¨çš„ç‰ˆæœ¬ä¸­ yumå…¨éƒ¨æ›´æ¢åˆ°dnf-3 æ•²yumç›¸å½“äºæ•²dnf**

```bash
[root@CitProbe ~] **ls -l /bin/yum**
lrwxrwxrwx. 1 root root 5 Mar 15  2023 /bin/yum -> dnf-3
```